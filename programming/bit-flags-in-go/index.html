<!doctype html><html lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Nico Braun - Bit Flags In Go</title><link rel=icon href=/assets/favicon.ico><link rel=stylesheet href=/assets/base.css><link rel=stylesheet href=/assets/main.css><link rel=stylesheet href=/assets/chroma.css><body class=darker><nav id=nav></nav><section id=page class=post><aside id=menu><div class="tree-root tree-level-0"><section class=tree-level-1><h3>Linux</h3><ul><li class="tree-child tree-level-2"><a href=/linux/kvm-qemu-in-wsl2/>Kvm Qemu In Wsl2</a></ul><ul><li class="tree-child tree-level-2"><a href=/linux/effective-make/>Effective Make</a></ul></section><section class=tree-level-1><h3>Kubernetes</h3><ul><li class="tree-child tree-level-2"><a href=/kubernetes/kubernetes-dns/>Kubernetes Dns</a></ul></section><section class=tree-level-1><h3>Infrastructure</h3><ul><li class="tree-child tree-level-2"><a href=/infrastructure/immutable-cluster/>Immutable Cluster</a></ul></section><section class=tree-level-1><h3>Container</h3><ul><li class="tree-child tree-level-2"><a href=/container/building-production-grade-container-images/>Building Production Grade Container Images</a></ul><ul><li class="tree-child tree-level-2"><a href=/container/advanced-entrypoint-techniques/>Advanced Entrypoint Techniques</a></ul><ul><li class="tree-child tree-level-2"><a href=/container/docker-sd-and-lb/>Docker Sd And Lb</a></ul></section><section class=tree-level-1><h3>Programming</h3><ul><li class="tree-child tree-level-2"><a href=/programming/bit-flags-in-go/>Bit Flags In Go</a></ul><ul><li class="tree-child tree-level-2"><a href=/programming/opengl-windows-vscode/>Opengl Windows Vscode</a></ul><ul><li class="tree-child tree-level-2"><a href=/programming/python-cheat-sheet/>Python Cheat Sheet</a></ul></section></div></aside><main id=content><nav><ul class=bread-crumbs><li><a href=/>Home</a><li role=separator class=vr>/<li><a href=/programming/>Programming</a><li role=separator class=vr>/<li><a href=/programming/bit-flags-in-go/>Bit Flags In Go</a></ul></nav><article class=post><section class=post-content><h1 id=bit-flags-in-go>Bit Flags in Go</h1><p>Sometimes options can be expressed using so called bit flags. When using bit
flags, each bit of a given byte is considered on its own to determine if a
specific option is set.<p>For example we might have a unsigned integer variable to define the combination
of the 3 colors: red, blue and green.<blockquote><p>The <code>0b</code> prefix indicates that this is the binary representation of a number.</blockquote><pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=kd>var</span> <span class=nx>rgb</span> <span class=kt>uint8</span> <span class=p>=</span> <span class=mi>0</span> <span class=nx>b</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>                    <span class=err>│</span> <span class=err>│</span> <span class=err>└─</span> <span class=nx>red</span>
</span></span><span class=line><span class=cl>                    <span class=err>│</span> <span class=err>└───</span> <span class=nx>green</span>
</span></span><span class=line><span class=cl>                    <span class=err>└─────</span> <span class=nx>blue</span>
</span></span></code></pre><p>Each color occupies on bit in the integer variable or <em>bit field</em>. Above, all
bits are set to 0, so we consider the respective colors to be <em>unset</em>.<p>Now we can use bitwise operators to manipulate individual bits of the rgb
variable.<p>In order to make it easier to manipulate the bits, we create a constant <em>bit
mask</em> for each color.<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>red</span>   <span class=kt>uint8</span> <span class=p>=</span> <span class=mb>0b001</span>
</span></span><span class=line><span class=cl>  <span class=nx>green</span> <span class=kt>uint8</span> <span class=p>=</span> <span class=mb>0b010</span>
</span></span><span class=line><span class=cl>  <span class=nx>blue</span>  <span class=kt>uint8</span> <span class=p>=</span> <span class=mb>0b100</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre><h2 id=set-a-bit>Set a bit</h2><p>If we want to turn on a particular color, we use the bitwise <code>OR</code> operator. This
will leave every bit in <code>rgb</code> untouched except for the <code>red</code> one. The <code>red</code> bit
is <em>set</em> set since the <code>OR</code> will set it if it is set in <code>rgb</code> or <code>red</code>.<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=nx>rgb</span> <span class=p>=</span> <span class=nx>rgb</span><span class=p>|</span><span class=nx>red</span> <span class=c1>// 001
</span></span></span></code></pre><h2 id=unset-a-bit>Unset a bit</h2><p>If we want to turn of a particular bit, we use the bitwise <code>AND NOT (&^)</code>. The
<code>XOR (^)</code> operator inverts the value of red. So every bit except for the red one
is turn on. Thus, when using te inverted value with the <code>AND (&)</code> operator, the
result is that every bit in rgb that was already turned on, remains turned on,
except for the red one. The red bit is always turned of because is is 0 in the
inverted value.<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=nx>rgb</span> <span class=p>=</span> <span class=nx>rgb</span> <span class=o>&amp;</span> <span class=p>^</span><span class=nx>red</span> <span class=c1>// 000
</span></span></span></code></pre><h2 id=toggle-a-bit>Toggle a bit</h2><p>If we want to toggle a bit, we use the bitwise <code>XOR (^)</code>. In below example we
are toggling the green bit of the rgb variable. This works because every bit
except for the green one is unset in our <code>green</code> const. Meaning all bits of
<code>rgb</code> except for the green one remain the same. The green one will be set or
unset depending on its current value. If its already set, <code>XOR</code> will unset it
because both <code>rgb</code> and green have it set. If its not set <code>XOR</code> will set it
because the it is set in the <code>green</code> variable but not in <code>rgb</code>.<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=nx>rgb</span> <span class=p>=</span> <span class=nx>rgb</span><span class=p>^</span><span class=nx>green</span> <span class=c1>// 010
</span></span></span></code></pre><h2 id=check-wether-a-bit-is-set-or-unset>Check wether a bit is set or unset</h2><p>If we want to check if a particular bit is set, we use the bitwise <code>AND (&)</code>
operator, and check if the result is greater than 0.<p>Because every bit except for the red bit is 0 in our variable <code>red</code>, the result
of using the <code>AND (&)</code> operator is that every bit except for red is turned to 0.
The red bit itself will only be 1 if it was already 1 in the rgb variable. So we
know if the result is 0, red is not 1 in the rgb variable.<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=nx>isRed</span> <span class=o>:=</span> <span class=nx>rgb</span><span class=o>&amp;</span><span class=nx>red</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=c1>// true
</span></span></span></code></pre><h2 id=iota>Iota</h2><p>Instead of defining each variable manually as uint8 and assigning a value to it,
we can make use if <code>iota</code>. First we declare a unit8 type called rgb. Then we use
iota in combination with <code>left shift (&lt;&lt;)</code> to define each color bit flag.<p>The value of <code>iota</code> is the ordinal position of the const declaration, starting
at 0. Therefore, in the below example, we set the first const declaration, red,
to 0b001 and shift its position by <code>iota</code> which is 0. So effectively we don't
shift at all. On the next declaration, green, we shift 0b001 by 1 resulting in
or 0b10. This pattern repeats until the end of the const block.<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl> <span class=nx>red</span>    <span class=nx>rgb</span> <span class=p>=</span> <span class=mb>0b001</span> <span class=o>&lt;&lt;</span> <span class=kc>iota</span> <span class=c1>// 0b1&lt;&lt;0 = 0b001
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>green</span>                      <span class=c1>// 0b1&lt;&lt;1 = 0b010
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>blue</span>                       <span class=c1>// 0b1&lt;&lt;2 = 0b100
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>)</span>
</span></span></code></pre><blockquote><p>iota is a predeclared identifier representing the untyped integer ordinal
number of the current const specification in a (usually parenthesized) const
declaration. It is zero-indexed.</blockquote><h2 id=short-hand-assignment>Short Hand Assignment</h2><p>Go supports shorthand assignment using bitwise operators.<p>For example, instead of:<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=nx>rgb</span> <span class=p>=</span> <span class=nx>rgb</span><span class=p>|</span><span class=nx>red</span><span class=p>|</span><span class=nx>blue</span>
</span></span></code></pre><p>We can write:<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=nx>rgb</span> <span class=o>|=</span> <span class=nx>red</span><span class=p>|</span><span class=nx>blue</span>
</span></span></code></pre><h2 id=example>Example</h2><pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl> <span class=nx>red</span> <span class=kt>byte</span> <span class=p>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=kc>iota</span>
</span></span><span class=line><span class=cl> <span class=nx>green</span>
</span></span><span class=line><span class=cl> <span class=nx>blue</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>configureLighting</span><span class=p>(</span><span class=nx>flags</span> <span class=kt>byte</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=nx>flags</span><span class=o>&amp;</span><span class=nx>red</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// turn on red lights
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=nx>flags</span><span class=o>&amp;</span><span class=nx>green</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// turn on green lights
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=nx>flags</span><span class=o>&amp;</span><span class=nx>blue</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// turn on blue lights
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nf>configureLighting</span><span class=p>(</span><span class=nx>red</span> <span class=p>|</span> <span class=nx>blue</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre><h2 id=bitwise-operators>Bitwise Operators</h2><p>Below is an overview of the bitwise operators in go.<pre tabindex=0 class=chroma><code><span class=line><span class=cl><span class=o>&amp;</span>    <span class=nx>bitwise</span> <span class=nx>AND</span>            <span class=nx>integers</span>
</span></span><span class=line><span class=cl><span class=p>|</span>    <span class=nx>bitwise</span> <span class=nx>OR</span>             <span class=nx>integers</span>
</span></span><span class=line><span class=cl><span class=p>^</span>    <span class=nx>bitwise</span> <span class=nx>XOR</span>            <span class=nx>integers</span>
</span></span><span class=line><span class=cl><span class=o>&amp;^</span>   <span class=nx>bit</span> <span class=nf>clear</span> <span class=p>(</span><span class=nx>AND</span> <span class=nx>NOT</span><span class=p>)</span>    <span class=nx>integers</span>
</span></span><span class=line><span class=cl><span class=o>&lt;&lt;</span>   <span class=nx>left</span> <span class=nx>shift</span>             <span class=nx>integer</span> <span class=o>&lt;&lt;</span> <span class=nx>integer</span> <span class=o>&gt;=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span>   <span class=nx>right</span> <span class=nx>shift</span>            <span class=nx>integer</span> <span class=o>&gt;&gt;</span> <span class=nx>integer</span> <span class=o>&gt;=</span> <span class=mi>0</span>
</span></span></code></pre></section><footer class=post-footer><p><span>Nico Braun</span>&nbsp;-&nbsp;<time>June 17, 2023</time><p><a href=#nav class=no-pop>Back to Top</a></footer></article></main><aside id=context><section class=toc><h3>What is on this page?</h3><ul><li><a href=#set-a-bit>Set a bit</a><li><a href=#unset-a-bit>Unset a bit</a><li><a href=#toggle-a-bit>Toggle a bit</a><li><a href=#check-wether-a-bit-is-set-or-unset>Check wether a bit is set or unset</a><li><a href=#iota>Iota</a><li><a href=#short-hand-assignment>Short Hand Assignment</a><li><a href=#example>Example</a><li><a href=#bitwise-operators>Bitwise Operators</a></ul></section><section class=releated><h3>Related</h3><ul><li><a href=/programming/opengl-windows-vscode/>Opengl Windows Vscode
<small>- Nico Braun</small>
<small>- June 11, 2022</small></a><li><a href=/programming/python-cheat-sheet/>Python Cheat Sheet
<small>- Nico Braun</small>
<small>- June 28, 2019</small></a></ul></section></aside></section><footer id=footer><section id=socials><a href=https://github.com/bluebrown class="social-link no-pop"><svg class="social-icon">
<path
  d="M8 0C3.58 0 0 3.582 0 8c0 3.535 2.292 6.533 5.47 7.59.4.075.547-.172.547-.385 0-.19-.007-.693-.01-1.36-2.226.483-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.725-.496.056-.486.056-.486.803.056 1.225.824 1.225.824.714 1.223 1.873.87 2.33.665.072-.517.278-.87.507-1.07-1.777-.2-3.644-.888-3.644-3.953 0-.873.31-1.587.823-2.147-.09-.202-.36-1.015.07-2.117 0 0 .67-.215 2.2.82.64-.178 1.32-.266 2-.27.68.004 1.36.092 2 .27 1.52-1.035 2.19-.82 2.19-.82.43 1.102.16 1.915.08 2.117.51.56.82 1.274.82 2.147 0 3.073-1.87 3.75-3.65 3.947.28.24.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.14.46.55.38C13.71 14.53 16 11.53 16 8c0-4.418-3.582-8-8-8" /></svg><span>bluebrown</span></a>
<a href=https://www.twitter.com/codingsafari class="social-link no-pop"><svg class="social-icon">
<path
  d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.37-1.337.64-2.085.79-.598-.64-1.45-1.04-2.396-1.04-1.812 0-3.282 1.47-3.282 3.28 0 .26.03.51.085.75-2.728-.13-5.147-1.44-6.766-3.42C.83 2.58.67 3.14.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.41-.02-.61-.058.42 1.304 1.63 2.253 3.07 2.28-1.12.88-2.54 1.404-4.07 1.404-.26 0-.52-.015-.78-.045 1.46.93 3.18 1.474 5.04 1.474 6.04 0 9.34-5 9.34-9.33 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7z" /></svg><span>codingsafari</span></a>
<a href=https://www.linkedin.com/in/nico-braun class="social-link no-pop"><svg class="social-icon">
<path
  d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51v1.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" /></svg><span>nico-braun</span></a>
<a href=https://stackoverflow.com/users/9208887/the-fool class="social-link no-pop"><svg class="social-icon">
<path
  d="M12.566,14.12v-4.08h1.359v5.44H1.686v-5.44h1.36v4.08H12.566z M10.336,0.52L9.269,1.315l3.978,5.358l1.068-0.803 L10.336,0.52z M4.406,12.76h6.8V11.4h-6.8V12.76z M12.158,7.945L7.03,3.675l0.851-1.02l5.128,4.271L12.158,7.945z M5.357,6.646 l6.053,2.815l0.558-1.21L5.916,5.437L5.357,6.64V6.646z M11.227,10.91L4.494,9.774l0.272-1.306l6.549,1.306L11.227,10.91z" /></svg><span>the-fool</span></a></section></footer>